{% extends "auctions/layout.html" %}

{% block body %}

<h2>{{ listing.title  }} {% if listing.category %} ({{ listing.category }}) {% endif %}</h2>
    <div>
        Current Bid: {{ listing.current_bid }}
        {% if user.is_authenticated %}
            {% if watching %}
                <form action="{% url 'unwatch' %}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="listing_id" value={{ listing.id }}>
                    <input type="submit" value="Unwatch">
                </form>
            {% else %}
                <form action="{% url 'watch' %}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="listing_id" value={{ listing.id }}>
                    <input type="submit" value="Watch">
                </form>
            {% endif %}
        {% endif %}        
    </div>
    <div>
        Bid History:
        <ol>
            {% for bid in bids %}
            <li>
                {{ bid.amount }} | {{ bid.time }} | {{ bid.user }}
            </li>
            {% endfor %}
            <li>
                Starting price: {{ listing.starting_bid }} 
            </li>
        </ol>
    </div>
    <div>
        <img src={{ listing.image_url }} height="100px">
    </div>
    <div>
        {{ listing.description }}
    </div>
    
{% endblock %}